!function(){Number.prototype.toPercent=function(){return(Math.round(1e4*this)/100).toFixed(2)+"%"};var e=function(n){if(!(this instanceof e))return new e(n);var w,d,r=this,p={},g=[],y={},m=[],x=(new Date).getTime(),l={id:"",level:3,levelDesc:["省份","城市","区县","乡镇","社区"],index:"996",separator:" / ",isInitClick:!0,isWithMouse:!1,offsetX:0,offsetY:0,emptyText:"暂无数据",color:"#56b4f8",fontSize:"14px",isAsync:!1,asyncUrl:"",isShowBtn:!0,btnConfig:[],data:""},b=l,c=20,t=!0;function s(e){if("string"==typeof e)try{var a=JSON.parse(e);return!("object"!=typeof a||!a)}catch(e){return}}function i(e){var a,t,i,n=$("#"+b.id).offset().left-10,l=$("#"+b.id).offset().top+$("#"+b.id).height()+5;return b.isWithMouse&&(a=e||window.event,t=document.documentElement.scrollLeft||document.body.scrollLeft,i=document.documentElement.scrollTop||document.body.scrollTop,n=a.pageX||a.clientX+t,l=a.pageY||a.clientY+i),{x:n+=b.offsetX,y:l+=b.offsetY}}function _(e){var a=$("#adp-wraper-"+x).children("div.ul-div").eq(e),t=a.find("ul li"),i=Math.ceil(t.length/5)*(c+16)+10;a.css("height",65<i?i:"65px")}function D(a,e){var t=[];if(b.isAsync){var i="",n="",l=1;if(null==a){if(void 0!==d&&null!=d)return d}else i=a.code,n=a.name?a.name:a.text,l=e;$.ajax({data:{code:i,name:n,level:l},url:b.asyncUrl,async:!1,success:function(e){"string"==typeof e&&s(e)&&(e=JSON.parse(e)),t=e,null==a&&void 0===d&&(d=e)}})}return t}return r._init=function(){if(function(){var e=!0;n instanceof Object?b=$.extend({},l,n):"string"==typeof n?b.id=n:e=!1;b.level>b.levelDesc.length&&(b.levelDesc=l.levelDesc);""==b.color&&(b.color=l.color);""==b.fontSize&&(b.fontSize=l.fontSize);(""==b.id||null==b.id||0==$("#"+b.id).length)&&(e=!1);!b.isAsync||"string"==typeof b.asyncUrl&&""!=b.asyncUrl||(b.isAsync=l.isAsync);"object"==typeof b.btnConfig&&null!=b.btnConfig||(b.isShowBtn=!1,b.btnConfig=l.btnConfig);return e}()){!function(){var e="",a=$("head script");if(0<a.length)for(var t=0;t<a.length;t++)if(-1!=a[t].src.indexOf("/js/address-picker.js")){e=a[t].src.substring(0,a[t].src.indexOf("/js/address-picker.js"));break}{var i,n,l;""!=e&&((i=document.querySelector(":root")).style.setProperty("--theme-color",b.color),i.style.setProperty("--font-size",b.fontSize),n=document.getElementsByTagName("head")[0],document.createElement("script"),(l=document.createElement("link")).href=e+"/css/address-picker.css",l.rel="stylesheet",l.type="text/css",n.appendChild(l),""==b.data&&(1==b.level||2==b.level?b.data=e+"/data/pc-code.json":4==b.level||5==b.level?b.data=e+"/data/pcas-code.json":b.data=e+"/data/pca-code.json"))}}();var e='<div id="adp-wraper-'+x+'" class="adp-wraper" style="z-index: '+b.index+'"><p>',a='<div class="ul-div" style="display: block"><ul></ul></div>';e+='<span class="adp-head-active">'+b.levelDesc[0]+"</span><span>"+b.levelDesc[0]+"</span>";for(var t=1;t<b.level;t++)e+="<span>"+b.levelDesc[t]+"</span>",a+='<div class="ul-div"><ul><span class="adp-empty-text">'+b.emptyText+"</span></ul></div>";e+="</p>";var i=function(){var e,a="";if(b.isShowBtn&&0<(e=b.btnConfig).length){a='<div class="adp-btn-area">';for(var t=0;t<e.length;t++)a+='<div id="adp_btn_'+t+'" class="adp-btn">'+e[t].text+"</div>";a+="</div>"}return a}();$("body").append(e+a+i+'</div><div class="adp-wraper-backshadow" style="z-index: '+(b.index-1)+'"></div>'),b.isAsync?(w=D(null),r._initFirstLevelData()):"string"!=typeof b.data||s(b.data)?(w=b.data,"string"==typeof b.data&&(w=JSON.parse(w)),r._getEachLevelData(0,b.level,w),r._initFirstLevelData()):$.ajax({url:b.data,async:!1,success:function(e){w=e,r._getEachLevelData(0,b.level,w),r._initFirstLevelData()}}),r._bindEvent()}},r._getEachLevelData=function(e,a,t){var i=[],n=[];if(!(a<=e)){for(var l=0;l<t.length;l++)if(i.push(t[l]),e!=a-1&&null!=t[l].children)for(var d=0;d<t[l].children.length;d++)n.push(t[l].children[d]);0!=n.length&&(p["data_level_"+e]=i,r._getEachLevelData(e+1,a,n))}},r._initFirstLevelData=function(){for(var e=0;e<b.level;e++)$("#adp-wraper-"+x).children("div").eq(e).children("ul").empty(),$("#adp-wraper-"+x).children("div").eq(e).children("ul").append('<span class="adp-empty-text">'+b.emptyText+"</span>");0<w.length&&$("#adp-wraper-"+x).children("div").eq(0).children("ul").empty();for(e=0;e<w.length;e++){var a='<li data-code="'+w[e].code+'" title="'+w[e].name+'">'+w[e].name+"</li>";$("#adp-wraper-"+x).children("div").eq(0).children("ul").append(a)}var t=$("#adp-wraper-"+x).children("p").children("span").eq(1).text(),i=$("#adp-wraper-"+x).children("p").children("span.adp-head-active");i.css("left","-1px"),i.text(t),$("#adp-wraper-"+x).children("div.ul-div").eq(0).show().siblings("div.ul-div").hide(),b.isShowBtn&&_(0)},r._bindEvent=function(){if($("#adp-wraper-"+x+" div ul").delegate("li","click",function(){var e=$(this).parent().parent().index();if(y.code=$(this).data("code"),y.text=$(this).text(),y.level=e,g[e-1]=$(this).data("code"),m[e-1]=$(this).text(),g.splice(e,g.length-e),m.splice(e,m.length-e),e<$("#adp-wraper-"+x).children("div.ul-div").length){for(var a=e;a<b.level;a++)$("#adp-wraper-"+x).children("div.ul-div").eq(a).children("ul").empty().append('<span class="adp-empty-text">'+b.emptyText+"</span>"),b.isShowBtn&&_(a);$("#adp-wraper-"+x).children("div.ul-div").eq(e).children("ul").empty();var t=b.isAsync?D(y,e):w;if(1<e&&!b.isAsync&&(t=p["data_level_"+(e-1)]),null!=t){for(var i=0;i<t.length;i++){var n=t[i];if(b.isAsync){var l='<li data-code="'+n.code+'" title="'+n.name+'">'+n.name+"</li>";$("#adp-wraper-"+x).children("div").eq(e).children("ul").append(l)}else if(n.name==$(this).text()&&n.code==$(this).data("code")){if(null!=n.children&&0<n.children.length)for(var d=0;d<n.children.length;d++){var r=n.children[d],l='<li data-code="'+r.code+'" title="'+r.name+'">'+r.name+"</li>";$("#adp-wraper-"+x).children("div.ul-div").eq(e).children("ul").append(l)}else $("#adp-wraper-"+x).children("div.ul-div").eq(e).children("ul").append('<span class="adp-empty-text">'+b.emptyText+"</span>");break}}b.isShowBtn&&_(e)}else $("#adp-wraper-"+x).children("div.ul-div").eq(e).children("ul").append('<span class="adp-empty-text">'+b.emptyText+"</span>");$(this).addClass("adp-active").siblings().removeClass("adp-active");var c=$("#adp-wraper-"+x).children("p").children("span").eq(e+1).text(),s=$("#adp-wraper-"+x).children("p").children("span.adp-head-active");s.css("left",(.2*e).toPercent()),$(this).parent().parent().next().show().siblings("div.ul-div").hide(),setTimeout(function(){s.text(c)},200)}else $(this).addClass("adp-active").siblings().removeClass("adp-active"),$("#adp-wraper-"+x).fadeOut(),$("div.adp-wraper-backshadow").hide()}),$("#adp-wraper-"+x+" p span").click(function(){var e,a,t;$(this).hasClass("adp-head-active")||(e=$(this).index()-1,a=$(this).text(),(t=$("#adp-wraper-"+x).children("p").children("span.adp-head-active")).css("left",0==e?-1:(.2*e).toPercent()),setTimeout(function(){t.text(a)},200),$("#adp-wraper-"+x).children("div").eq(e).show().siblings("div.ul-div").hide())}),$("div.adp-wraper-backshadow").on("click",function(){$("div.adp-wraper-backshadow").hide(),$("#adp-wraper-"+x).fadeOut()}),b.isInitClick&&$("#"+b.id).on("click",function(){var e=i(event),a=$("#adp-wraper-"+x+" div.ul-div").eq(0);$("#adp-wraper-"+x).css("left",e.x),$("#adp-wraper-"+x).css("top",e.y),$("#adp-wraper-"+x).fadeIn(),(null==y.level||t)&&b.isShowBtn&&(0!=a.children("ul").children("li").height()&&(c=a.children("ul").children("li").height()),_(0),t=!1),$(".adp-wraper-backshadow").show()}),b.isShowBtn)for(var e=b.btnConfig,a=0;a<e.length;a++)"function"==typeof e[a].click&&$("#adp_btn_"+a).on("click",e[a].click)},r._clearSelectedData=function(){g=[],m=[],y={};var e=$("#adp-wraper-"+x).children("p").children("span.adp-head-active");e.css("left","-1px"),setTimeout(function(){e.text(b.levelDesc[0])},200);for(var a,t=1;t<b.level;t++)$("#adp-wraper-"+x).children("div.ul-div").eq(t).children("ul").empty().append('<span class="adp-empty-text">'+b.emptyText+"</span>"),b.isShowBtn&&_(t);0<(a=$("#adp-wraper-"+x).children("div.ul-div").eq(0).children("ul").children("li.adp-active")).length&&a.removeClass("adp-active"),$("#adp-wraper-"+x).children("div").eq(0).show().siblings("div.ul-div").hide()},r._setSelectedData=function(e){if("object"==typeof e&&null!=e&&!(e.length>b.level||0==e.length)){var a=b.isAsync?D(null):w;if("object"==typeof a&&null!=a){for(var t,i,n,l,d="",r=!1,c=$("#adp-wraper-"+x).children("div.ul-div").eq(0).children("ul"),s=0;s<(n=c.children("li")).length;s++)(t=a[s]).code!=e[0]||(y.code=t.code,y.text=t.name,y.level=1,g[0]=t.code,m[0]=t.name,g.splice(1,g.length-1),m.splice(1,m.length-1),i=t,r=!(l=0),c.children("li").removeClass("adp-active"),$(n[s]).addClass("adp-active"));if(r){for(var p=1;p<e.length&&(null!=e[p]&&""!=e[p]);p++){var o=b.isAsync?D(i,y.level):i.children;if("object"!=typeof o||null==o)break;d="",r=!1,i={};for(var h=0;h<o.length;h++)o[h].code!=e[p]?d+='<li data-code="'+o[h].code+'" title="'+o[h].name+'">'+o[h].name+"</li>":(d+='<li data-code="'+o[h].code+'" title="'+o[h].name+'" class="adp-active">'+o[h].name+"</li>",y.code=o[h].code,y.text=o[h].name,y.level=p+1,g[p]=o[h].code,m[p]=o[h].name,g.splice(p+1,g.length-p-1),m.splice(p+1,m.length-p-1),i=o[h],r=!0,l=p);if(!r)break;$("#adp-wraper-"+x).children("div.ul-div").eq(p).children("ul").empty().append(d),b.isShowBtn&&_(p)}if("number"==typeof l){$("#adp-wraper-"+x).children("div.ul-div").eq(l).show().siblings("div.ul-div").hide();var v=$("#adp-wraper-"+x).children("p").children("span").eq(l+1).text(),u=$("#adp-wraper-"+x).children("p").children("span.adp-head-active");u.css("left",(.2*l).toPercent()),setTimeout(function(){u.text(v)},200);for(var f=l+1;f<b.level;f++)$("#adp-wraper-"+x).children("div.ul-div").eq(f).children("ul").empty().append('<span class="adp-empty-text">'+b.emptyText+"</span>"),b.isShowBtn&&_(f)}}}}},r._refreshData=function(e){"string"==typeof e&&s(e)&&(e=JSON.parse(e)),0<(w=e).length&&r._getEachLevelData(0,b.level,w),r._initFirstLevelData()},r._getTotalValueAsArray=function(){return{code:g,text:m}},r._getTotalValueAsText=function(){for(var e="",a=0;a<y.level;a++)e+=a<y.level-1?m[a]+b.separator:m[a];return e},r._getCurrentObject=function(){return y},r._show=function(){var e=i(event);$("#adp-wraper-"+x).css("left",e.x),$("#adp-wraper-"+x).css("top",e.y),$("#adp-wraper-"+x).fadeIn(),$(".adp-wraper-backshadow").show()},r._hide=function(){$("#adp-wraper-"+x).fadeOut(),$("div.adp-wraper-backshadow").hide()},r._on=function(e,a){$("#adp-wraper-"+x+" div ul").delegate("li",e,a)},r._init(),{on:r._on,show:r._show,hide:r._hide,refreshData:r._refreshData,getCurrentObject:r._getCurrentObject,getTotalValueAsArray:r._getTotalValueAsArray,getTotalValueAsText:r._getTotalValueAsText,clearSelectedData:r._clearSelectedData,setSelectedData:r._setSelectedData}};window.addressPicker=e}();